<!DOCTYPE html>
<html lang="en">

  <head>
  <style>
    .no-js {
      visibility: visible !important;
    }
  </style>

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Converting an audio album to a YouTube video</title>

  <link rel="stylesheet" href="/assets/main.css">
  <link rel="canonical" href="https://blog.karimratib.me/2018/01/09/youtube-album.html">
  <link rel="alternate" type="application/rss+xml" title="infojunkie" href="/feed.xml">

  <link rel="shortcut icon" href="/favicon.ico">

  <script src="https://cdn.jsdelivr.net/combine/npm/tone@14.7.58,npm/@magenta/music@1.23.1/es6/core.js,npm/focus-visible@5,npm/html-midi-player@1.4.0"></script>

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Converting an audio album to a YouTube video | infojunkie</title>
<meta name="generator" content="Jekyll v4.3.3" />
<meta property="og:title" content="Converting an audio album to a YouTube video" />
<meta name="author" content="Karim Ratib" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Changelog Aug 23, 2021 Adding youtube-chapters script YouTube is a great way to quickly disseminate obscure, long-tail music albums that carry cultural significance. As long as you remain under the radar of our friends at the music labels, of course :wink: Here’s a recipe to prepare audio files for YouTube upload. The video is a looping slideshow of the images contained in the album’s artwork. Here’s an example of this recipe’s output: Requires: imagemagick ffmpeg metaflac sox If you have just one cover image to show, and you want one video file per track, you can take the following shortcut: for f in *.flac; do ffmpeg -loop 1 -i cover.png -i &quot;$f&quot; -shortest -codec:v libx264 -crf 21 -bf 2 -flags +cgop -pix_fmt yuv420p -codec:a aac -strict -2 -b:a 384k -r:a 48000 -movflags faststart &quot;${f/.flac/.mp4}&quot;; done Otherwise, read on: Convert images to required size. Here I assume PNG files and output to png/ folder. See http://www.imagemagick.org/Usage/crop/#extent for f in *.png; do convert &quot;$f&quot; -resize 800x600 -gravity center -background black -extent 800x600 png/&quot;$f&quot;.png; done Generate video out of pngs. Here each image is shown for 20 seconds. See https://trac.ffmpeg.org/wiki/Slideshow and https://en.wikibooks.org/wiki/FFMPEG_An_Intermediate_Guide/image_sequence#Filename_patterns ffmpeg -framerate 1/20 -pattern_type glob -i &quot;png/*.png&quot; -c:v libx264 -vf &quot;fps=25,format=yuv420p&quot; png.mp4 Concatenate audio files. See https://trac.ffmpeg.org/wiki/Concatenate printf &quot;file &#39;%s&#39;\n&quot; ./*.flac &gt; files.txt ffmpeg -f concat -safe 0 -i files.txt files.flac Concatenate png video enough times to cover audio duration - in the example below we make 10 copies. See http://superuser.com/a/1116107/55867 for i in {.10}; do printf &quot;file &#39;%s&#39;\n&quot; png.mp4 &gt;&gt; pngs.txt; done ffmpeg -f concat -safe 0 -i pngs.txt -c copy pngs.mp4 Create YouTube video using acceptable encoding settings. See https://www.virag.si/2015/06/encoding-videos-for-youtube-with-ffmpeg ffmpeg -i pngs.mp4 -i files.flac -shortest -codec:v libx264 -crf 21 -bf 2 -flags +cgop -pix_fmt yuv420p -codec:a aac -strict -2 -b:a 384k -r:a 48000 -movflags faststart youtube.mp4 Generate a YouTube track listing to copy-paste in the video description: youtube-playlist.sh *.flac #!/bin/bash # youtube-playlist.sh # Show album track list in YouTube-friendly format including # clickable track offsets. # # Only works with .flac atm :-( # # Requires: metaflac sox start=0 for f in &quot;$@&quot; do offset=$(date -u -d &quot;0 $start sec&quot; +&quot;%H:%M:%S&quot;) title=$(metaflac &quot;$f&quot; --show-tag=TITLE | sed s/.*=//g) trackno=$(metaflac &quot;$f&quot; --show-tag=TRACKNUMBER | sed s/.*=//g) echo &quot;$offset&quot; &quot;$trackno&quot; &quot;$title&quot; end=$(soxi -D &quot;$f&quot;) start=$(bc -l &lt;&lt;&lt; &quot;$start + $end&quot;) done Generate a video file with chapters: youtube-chapters.sh *.flac &gt; chapters ffmpeg -i youtube.mp4 -i chapters -map_metadata 1 -codec copy youtube-chapters.mp4 #!/bin/bash # youtube-chapters.sh # Show album track list in ffmpeg metadata format # # Only works with .flac atm :-( # # Requires: metaflac sox # https://stackoverflow.com/a/43444305/209184 round() { printf &quot;%.${2}f&quot; &quot;${1}&quot; } echo &quot;;FFMETADATA1&quot; offset=0 for f in &quot;$@&quot; do start=$(round $offset 0) echo &quot;[CHAPTER]&quot; echo &quot;TIMEBASE=1/1000&quot; echo &quot;START=$start&quot; delta=$(soxi -D &quot;$f&quot;) offset=$(bc -l &lt;&lt;&lt; &quot;$offset + ($delta * 1000)&quot;) end=$(round $offset 0) echo &quot;END=$end&quot; title=$(metaflac &quot;$f&quot; --show-tag=TITLE | sed s/.*=//g) echo &quot;TITLE=$title&quot; done Originally published as a GitHub gist." />
<meta property="og:description" content="Changelog Aug 23, 2021 Adding youtube-chapters script YouTube is a great way to quickly disseminate obscure, long-tail music albums that carry cultural significance. As long as you remain under the radar of our friends at the music labels, of course :wink: Here’s a recipe to prepare audio files for YouTube upload. The video is a looping slideshow of the images contained in the album’s artwork. Here’s an example of this recipe’s output: Requires: imagemagick ffmpeg metaflac sox If you have just one cover image to show, and you want one video file per track, you can take the following shortcut: for f in *.flac; do ffmpeg -loop 1 -i cover.png -i &quot;$f&quot; -shortest -codec:v libx264 -crf 21 -bf 2 -flags +cgop -pix_fmt yuv420p -codec:a aac -strict -2 -b:a 384k -r:a 48000 -movflags faststart &quot;${f/.flac/.mp4}&quot;; done Otherwise, read on: Convert images to required size. Here I assume PNG files and output to png/ folder. See http://www.imagemagick.org/Usage/crop/#extent for f in *.png; do convert &quot;$f&quot; -resize 800x600 -gravity center -background black -extent 800x600 png/&quot;$f&quot;.png; done Generate video out of pngs. Here each image is shown for 20 seconds. See https://trac.ffmpeg.org/wiki/Slideshow and https://en.wikibooks.org/wiki/FFMPEG_An_Intermediate_Guide/image_sequence#Filename_patterns ffmpeg -framerate 1/20 -pattern_type glob -i &quot;png/*.png&quot; -c:v libx264 -vf &quot;fps=25,format=yuv420p&quot; png.mp4 Concatenate audio files. See https://trac.ffmpeg.org/wiki/Concatenate printf &quot;file &#39;%s&#39;\n&quot; ./*.flac &gt; files.txt ffmpeg -f concat -safe 0 -i files.txt files.flac Concatenate png video enough times to cover audio duration - in the example below we make 10 copies. See http://superuser.com/a/1116107/55867 for i in {.10}; do printf &quot;file &#39;%s&#39;\n&quot; png.mp4 &gt;&gt; pngs.txt; done ffmpeg -f concat -safe 0 -i pngs.txt -c copy pngs.mp4 Create YouTube video using acceptable encoding settings. See https://www.virag.si/2015/06/encoding-videos-for-youtube-with-ffmpeg ffmpeg -i pngs.mp4 -i files.flac -shortest -codec:v libx264 -crf 21 -bf 2 -flags +cgop -pix_fmt yuv420p -codec:a aac -strict -2 -b:a 384k -r:a 48000 -movflags faststart youtube.mp4 Generate a YouTube track listing to copy-paste in the video description: youtube-playlist.sh *.flac #!/bin/bash # youtube-playlist.sh # Show album track list in YouTube-friendly format including # clickable track offsets. # # Only works with .flac atm :-( # # Requires: metaflac sox start=0 for f in &quot;$@&quot; do offset=$(date -u -d &quot;0 $start sec&quot; +&quot;%H:%M:%S&quot;) title=$(metaflac &quot;$f&quot; --show-tag=TITLE | sed s/.*=//g) trackno=$(metaflac &quot;$f&quot; --show-tag=TRACKNUMBER | sed s/.*=//g) echo &quot;$offset&quot; &quot;$trackno&quot; &quot;$title&quot; end=$(soxi -D &quot;$f&quot;) start=$(bc -l &lt;&lt;&lt; &quot;$start + $end&quot;) done Generate a video file with chapters: youtube-chapters.sh *.flac &gt; chapters ffmpeg -i youtube.mp4 -i chapters -map_metadata 1 -codec copy youtube-chapters.mp4 #!/bin/bash # youtube-chapters.sh # Show album track list in ffmpeg metadata format # # Only works with .flac atm :-( # # Requires: metaflac sox # https://stackoverflow.com/a/43444305/209184 round() { printf &quot;%.${2}f&quot; &quot;${1}&quot; } echo &quot;;FFMETADATA1&quot; offset=0 for f in &quot;$@&quot; do start=$(round $offset 0) echo &quot;[CHAPTER]&quot; echo &quot;TIMEBASE=1/1000&quot; echo &quot;START=$start&quot; delta=$(soxi -D &quot;$f&quot;) offset=$(bc -l &lt;&lt;&lt; &quot;$offset + ($delta * 1000)&quot;) end=$(round $offset 0) echo &quot;END=$end&quot; title=$(metaflac &quot;$f&quot; --show-tag=TITLE | sed s/.*=//g) echo &quot;TITLE=$title&quot; done Originally published as a GitHub gist." />
<link rel="canonical" href="https://blog.karimratib.me/2018/01/09/youtube-album.html" />
<meta property="og:url" content="https://blog.karimratib.me/2018/01/09/youtube-album.html" />
<meta property="og:site_name" content="infojunkie" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-01-09T00:00:00-08:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Converting an audio album to a YouTube video" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Karim Ratib"},"dateModified":"2018-01-09T00:00:00-08:00","datePublished":"2018-01-09T00:00:00-08:00","description":"Changelog Aug 23, 2021 Adding youtube-chapters script YouTube is a great way to quickly disseminate obscure, long-tail music albums that carry cultural significance. As long as you remain under the radar of our friends at the music labels, of course :wink: Here’s a recipe to prepare audio files for YouTube upload. The video is a looping slideshow of the images contained in the album’s artwork. Here’s an example of this recipe’s output: Requires: imagemagick ffmpeg metaflac sox If you have just one cover image to show, and you want one video file per track, you can take the following shortcut: for f in *.flac; do ffmpeg -loop 1 -i cover.png -i &quot;$f&quot; -shortest -codec:v libx264 -crf 21 -bf 2 -flags +cgop -pix_fmt yuv420p -codec:a aac -strict -2 -b:a 384k -r:a 48000 -movflags faststart &quot;${f/.flac/.mp4}&quot;; done Otherwise, read on: Convert images to required size. Here I assume PNG files and output to png/ folder. See http://www.imagemagick.org/Usage/crop/#extent for f in *.png; do convert &quot;$f&quot; -resize 800x600 -gravity center -background black -extent 800x600 png/&quot;$f&quot;.png; done Generate video out of pngs. Here each image is shown for 20 seconds. See https://trac.ffmpeg.org/wiki/Slideshow and https://en.wikibooks.org/wiki/FFMPEG_An_Intermediate_Guide/image_sequence#Filename_patterns ffmpeg -framerate 1/20 -pattern_type glob -i &quot;png/*.png&quot; -c:v libx264 -vf &quot;fps=25,format=yuv420p&quot; png.mp4 Concatenate audio files. See https://trac.ffmpeg.org/wiki/Concatenate printf &quot;file &#39;%s&#39;\\n&quot; ./*.flac &gt; files.txt ffmpeg -f concat -safe 0 -i files.txt files.flac Concatenate png video enough times to cover audio duration - in the example below we make 10 copies. See http://superuser.com/a/1116107/55867 for i in {.10}; do printf &quot;file &#39;%s&#39;\\n&quot; png.mp4 &gt;&gt; pngs.txt; done ffmpeg -f concat -safe 0 -i pngs.txt -c copy pngs.mp4 Create YouTube video using acceptable encoding settings. See https://www.virag.si/2015/06/encoding-videos-for-youtube-with-ffmpeg ffmpeg -i pngs.mp4 -i files.flac -shortest -codec:v libx264 -crf 21 -bf 2 -flags +cgop -pix_fmt yuv420p -codec:a aac -strict -2 -b:a 384k -r:a 48000 -movflags faststart youtube.mp4 Generate a YouTube track listing to copy-paste in the video description: youtube-playlist.sh *.flac #!/bin/bash # youtube-playlist.sh # Show album track list in YouTube-friendly format including # clickable track offsets. # # Only works with .flac atm :-( # # Requires: metaflac sox start=0 for f in &quot;$@&quot; do offset=$(date -u -d &quot;0 $start sec&quot; +&quot;%H:%M:%S&quot;) title=$(metaflac &quot;$f&quot; --show-tag=TITLE | sed s/.*=//g) trackno=$(metaflac &quot;$f&quot; --show-tag=TRACKNUMBER | sed s/.*=//g) echo &quot;$offset&quot; &quot;$trackno&quot; &quot;$title&quot; end=$(soxi -D &quot;$f&quot;) start=$(bc -l &lt;&lt;&lt; &quot;$start + $end&quot;) done Generate a video file with chapters: youtube-chapters.sh *.flac &gt; chapters ffmpeg -i youtube.mp4 -i chapters -map_metadata 1 -codec copy youtube-chapters.mp4 #!/bin/bash # youtube-chapters.sh # Show album track list in ffmpeg metadata format # # Only works with .flac atm :-( # # Requires: metaflac sox # https://stackoverflow.com/a/43444305/209184 round() { printf &quot;%.${2}f&quot; &quot;${1}&quot; } echo &quot;;FFMETADATA1&quot; offset=0 for f in &quot;$@&quot; do start=$(round $offset 0) echo &quot;[CHAPTER]&quot; echo &quot;TIMEBASE=1/1000&quot; echo &quot;START=$start&quot; delta=$(soxi -D &quot;$f&quot;) offset=$(bc -l &lt;&lt;&lt; &quot;$offset + ($delta * 1000)&quot;) end=$(round $offset 0) echo &quot;END=$end&quot; title=$(metaflac &quot;$f&quot; --show-tag=TITLE | sed s/.*=//g) echo &quot;TITLE=$title&quot; done Originally published as a GitHub gist.","headline":"Converting an audio album to a YouTube video","mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.karimratib.me/2018/01/09/youtube-album.html"},"url":"https://blog.karimratib.me/2018/01/09/youtube-album.html"}</script>
<!-- End Jekyll SEO tag -->

</head>


  <body style="visibility: hidden;" class="no-js">
    <script>
      // FOUC handling
      // https://www.primative.net/blog/how-to-get-rid-of-the-flash-of-unstyled-content/
      const domReady = (cb) => {
        document.readyState === 'interactive' || document.readyState === 'complete'
          ? cb()
          : document.addEventListener('DOMContentLoaded', cb);
      };
      domReady(() => {
        // Display body when DOM is loaded
        document.body.style.visibility = 'visible';
      });

      // If JS is disabled, "no-js" class causes body to be visible from the beginning.
      // If JS is enabled, remove the "no-js" class will force-hide the body until the above kicks in.
      document.querySelector('body').classList.remove('no-js');
    </script>

    <header class="site-header" role="banner">

  <div class="wrapper">
    
    
    <a class="site-title" href="/">
      
        infojunkie
      
    </a>

    
      <nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger">
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewbox="0 0 18 15" width="18px" height="15px">
              <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"></path>
              <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"></path>
              <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"></path>
            </svg>
          </span>
        </label>

        <div class="trigger">
          
            
            
            <a class="page-link" href="/about/">about</a>
            
          
            
            
            <a class="page-link" href="/drupal.html">drupal</a>
            
          
            
            
            <a class="page-link" href="/demos/">music</a>
            
          
        </div>
      </nav>
    
  </div>
</header>


    <main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title" itemprop="name headline">Converting an audio album to a YouTube video</h1>
    <p class="post-meta">
      <time datetime="2018-01-09T00:00:00-08:00" itemprop="datePublished">
        
        Jan 9, 2018
      </time>
      </p>
  </header>

  <div class="post-content" itemprop="articleBody">
    <table class="changelog">
  <thead>
    <th>Changelog</th>
    <th></th>
  </thead>
  <tbody>


  <tr>
    
    
      <td>Aug 23, 2021 </td>
    
      <td> Adding youtube-chapters script</td>
    
  </tr>

  </tbody>
</table>

<p>YouTube is a great way to quickly disseminate obscure, long-tail music albums that carry cultural significance. As long as you remain under the radar of our friends at the music labels, of course <img class="emoji" title=":wink:" alt=":wink:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f609.png" height="20" width="20"></p>

<p>Here’s a recipe to prepare audio files for YouTube upload. The video is a looping slideshow of the images contained in the album’s artwork. Here’s an example of this recipe’s output:</p>

<iframe width="800" height="600" src="https://www.youtube.com/embed/qjlDT819Q3s?feature=oembed" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen="" title="Hassan El Hadi حسن الهادي - Salam Québec (2003) [FULL ALBUM]"></iframe>

<p>Requires: <code class="language-plaintext highlighter-rouge">imagemagick ffmpeg metaflac sox</code></p>

<p>If you have just one cover image to show, and you want one video file per track, you can take the following shortcut:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">for </span>f <span class="k">in</span> <span class="k">*</span>.flac<span class="p">;</span> <span class="k">do </span>ffmpeg <span class="nt">-loop</span> 1 <span class="nt">-i</span> cover.png <span class="nt">-i</span> <span class="s2">"</span><span class="nv">$f</span><span class="s2">"</span> <span class="nt">-shortest</span> <span class="nt">-codec</span>:v libx264 <span class="nt">-crf</span> 21 <span class="nt">-bf</span> 2 <span class="nt">-flags</span> +cgop <span class="nt">-pix_fmt</span> yuv420p <span class="nt">-codec</span>:a aac <span class="nt">-strict</span> <span class="nt">-2</span> <span class="nt">-b</span>:a 384k <span class="nt">-r</span>:a 48000 <span class="nt">-movflags</span> faststart <span class="s2">"</span><span class="k">${</span><span class="nv">f</span><span class="p">/.flac/.mp4</span><span class="k">}</span><span class="s2">"</span><span class="p">;</span> <span class="k">done</span>
</code></pre></div></div>

<p>Otherwise, read on:</p>

<p>Convert images to required size. Here I assume PNG files and output to <code class="language-plaintext highlighter-rouge">png/</code> folder. See <a href="http://www.imagemagick.org/Usage/crop/#extent" rel="noopener noreferrer" target="_blank">http://www.imagemagick.org/Usage/crop/#extent</a></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">for </span>f <span class="k">in</span> <span class="k">*</span>.png<span class="p">;</span> <span class="k">do </span>convert <span class="s2">"</span><span class="nv">$f</span><span class="s2">"</span> <span class="nt">-resize</span> 800x600 <span class="nt">-gravity</span> center <span class="nt">-background</span> black <span class="nt">-extent</span> 800x600 png/<span class="s2">"</span><span class="nv">$f</span><span class="s2">"</span>.png<span class="p">;</span> <span class="k">done</span>
</code></pre></div></div>

<p>Generate video out of pngs. Here each image is shown for 20 seconds. See <a href="https://trac.ffmpeg.org/wiki/Slideshow" rel="noopener noreferrer" target="_blank">https://trac.ffmpeg.org/wiki/Slideshow</a> and <a href="https://en.wikibooks.org/wiki/FFMPEG_An_Intermediate_Guide/image_sequence#Filename_patterns" rel="noopener noreferrer" target="_blank">https://en.wikibooks.org/wiki/FFMPEG_An_Intermediate_Guide/image_sequence#Filename_patterns</a></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ffmpeg <span class="nt">-framerate</span> 1/20 <span class="nt">-pattern_type</span> glob <span class="nt">-i</span> <span class="s2">"png/*.png"</span> <span class="nt">-c</span>:v libx264 <span class="nt">-vf</span> <span class="s2">"fps=25,format=yuv420p"</span> png.mp4
</code></pre></div></div>

<p>Concatenate audio files. See <a href="https://trac.ffmpeg.org/wiki/Concatenate" rel="noopener noreferrer" target="_blank">https://trac.ffmpeg.org/wiki/Concatenate</a></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">printf</span> <span class="s2">"file '%s'</span><span class="se">\n</span><span class="s2">"</span> ./<span class="k">*</span>.flac <span class="o">&gt;</span> files.txt
ffmpeg <span class="nt">-f</span> concat <span class="nt">-safe</span> 0 <span class="nt">-i</span> files.txt files.flac
</code></pre></div></div>

<p>Concatenate png video enough times to cover audio duration - in the example below we make 10 copies. See <a href="http://superuser.com/a/1116107/55867" rel="noopener noreferrer" target="_blank">http://superuser.com/a/1116107/55867</a></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">for </span>i <span class="k">in</span> <span class="o">{</span>.10<span class="o">}</span><span class="p">;</span> <span class="k">do </span><span class="nb">printf</span> <span class="s2">"file '%s'</span><span class="se">\n</span><span class="s2">"</span> png.mp4 <span class="o">&gt;&gt;</span> pngs.txt<span class="p">;</span> <span class="k">done
</span>ffmpeg <span class="nt">-f</span> concat <span class="nt">-safe</span> 0 <span class="nt">-i</span> pngs.txt <span class="nt">-c</span> copy pngs.mp4
</code></pre></div></div>

<p>Create YouTube video using acceptable encoding settings. See <a href="https://www.virag.si/2015/06/encoding-videos-for-youtube-with-ffmpeg" rel="noopener noreferrer" target="_blank">https://www.virag.si/2015/06/encoding-videos-for-youtube-with-ffmpeg</a></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ffmpeg <span class="nt">-i</span> pngs.mp4 <span class="nt">-i</span> files.flac <span class="nt">-shortest</span> <span class="nt">-codec</span>:v libx264 <span class="nt">-crf</span> 21 <span class="nt">-bf</span> 2 <span class="nt">-flags</span> +cgop <span class="nt">-pix_fmt</span> yuv420p <span class="nt">-codec</span>:a aac <span class="nt">-strict</span> <span class="nt">-2</span> <span class="nt">-b</span>:a 384k <span class="nt">-r</span>:a 48000 <span class="nt">-movflags</span> faststart youtube.mp4
</code></pre></div></div>

<p>Generate a YouTube track listing to copy-paste in the video description:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>youtube-playlist.sh <span class="k">*</span>.flac
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/bin/bash</span>

<span class="c"># youtube-playlist.sh</span>
<span class="c"># Show album track list in YouTube-friendly format including</span>
<span class="c"># clickable track offsets.</span>
<span class="c">#</span>
<span class="c"># Only works with .flac atm :-(</span>
<span class="c">#</span>
<span class="c"># Requires: metaflac sox</span>

<span class="nv">start</span><span class="o">=</span>0
<span class="k">for </span>f <span class="k">in</span> <span class="s2">"</span><span class="nv">$@</span><span class="s2">"</span>
<span class="k">do
        </span><span class="nv">offset</span><span class="o">=</span><span class="si">$(</span><span class="nb">date</span> <span class="nt">-u</span> <span class="nt">-d</span> <span class="s2">"0 </span><span class="nv">$start</span><span class="s2"> sec"</span> +<span class="s2">"%H:%M:%S"</span><span class="si">)</span>
        <span class="nv">title</span><span class="o">=</span><span class="si">$(</span>metaflac <span class="s2">"</span><span class="nv">$f</span><span class="s2">"</span> <span class="nt">--show-tag</span><span class="o">=</span>TITLE | <span class="nb">sed </span>s/.<span class="k">*</span><span class="o">=</span>//g<span class="si">)</span>
        <span class="nv">trackno</span><span class="o">=</span><span class="si">$(</span>metaflac <span class="s2">"</span><span class="nv">$f</span><span class="s2">"</span> <span class="nt">--show-tag</span><span class="o">=</span>TRACKNUMBER | <span class="nb">sed </span>s/.<span class="k">*</span><span class="o">=</span>//g<span class="si">)</span>
        <span class="nb">echo</span> <span class="s2">"</span><span class="nv">$offset</span><span class="s2">"</span> <span class="s2">"</span><span class="nv">$trackno</span><span class="s2">"</span> <span class="s2">"</span><span class="nv">$title</span><span class="s2">"</span>
        <span class="nv">end</span><span class="o">=</span><span class="si">$(</span>soxi <span class="nt">-D</span> <span class="s2">"</span><span class="nv">$f</span><span class="s2">"</span><span class="si">)</span>
        <span class="nv">start</span><span class="o">=</span><span class="si">$(</span>bc <span class="nt">-l</span> <span class="o">&lt;&lt;&lt;</span> <span class="s2">"</span><span class="nv">$start</span><span class="s2"> + </span><span class="nv">$end</span><span class="s2">"</span><span class="si">)</span>
<span class="k">done</span>
</code></pre></div></div>

<p>Generate a video file with chapters:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>youtube-chapters.sh <span class="k">*</span>.flac <span class="o">&gt;</span> chapters
ffmpeg <span class="nt">-i</span> youtube.mp4 <span class="nt">-i</span> chapters <span class="nt">-map_metadata</span> 1 <span class="nt">-codec</span> copy youtube-chapters.mp4
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/bin/bash</span>

<span class="c"># youtube-chapters.sh</span>
<span class="c"># Show album track list in ffmpeg metadata format</span>
<span class="c">#</span>
<span class="c"># Only works with .flac atm :-(</span>
<span class="c">#</span>
<span class="c"># Requires: metaflac sox</span>

<span class="c"># https://stackoverflow.com/a/43444305/209184</span>
round<span class="o">()</span> <span class="o">{</span>
	<span class="nb">printf</span> <span class="s2">"%.</span><span class="k">${</span><span class="nv">2</span><span class="k">}</span><span class="s2">f"</span> <span class="s2">"</span><span class="k">${</span><span class="nv">1</span><span class="k">}</span><span class="s2">"</span>
<span class="o">}</span>

<span class="nb">echo</span> <span class="s2">";FFMETADATA1"</span>

<span class="nv">offset</span><span class="o">=</span>0
<span class="k">for </span>f <span class="k">in</span> <span class="s2">"</span><span class="nv">$@</span><span class="s2">"</span>
<span class="k">do
	</span><span class="nv">start</span><span class="o">=</span><span class="si">$(</span>round <span class="nv">$offset</span> 0<span class="si">)</span>
	<span class="nb">echo</span> <span class="s2">"[CHAPTER]"</span>
	<span class="nb">echo</span> <span class="s2">"TIMEBASE=1/1000"</span>
	<span class="nb">echo</span> <span class="s2">"START=</span><span class="nv">$start</span><span class="s2">"</span>
	<span class="nv">delta</span><span class="o">=</span><span class="si">$(</span>soxi <span class="nt">-D</span> <span class="s2">"</span><span class="nv">$f</span><span class="s2">"</span><span class="si">)</span>
	<span class="nv">offset</span><span class="o">=</span><span class="si">$(</span>bc <span class="nt">-l</span> <span class="o">&lt;&lt;&lt;</span> <span class="s2">"</span><span class="nv">$offset</span><span class="s2"> + (</span><span class="nv">$delta</span><span class="s2"> * 1000)"</span><span class="si">)</span>
	<span class="nv">end</span><span class="o">=</span><span class="si">$(</span>round <span class="nv">$offset</span> 0<span class="si">)</span>
	<span class="nb">echo</span> <span class="s2">"END=</span><span class="nv">$end</span><span class="s2">"</span>
	<span class="nv">title</span><span class="o">=</span><span class="si">$(</span>metaflac <span class="s2">"</span><span class="nv">$f</span><span class="s2">"</span> <span class="nt">--show-tag</span><span class="o">=</span>TITLE | <span class="nb">sed </span>s/.<span class="k">*</span><span class="o">=</span>//g<span class="si">)</span>
	<span class="nb">echo</span> <span class="s2">"TITLE=</span><span class="nv">$title</span><span class="s2">"</span>
<span class="k">done</span>
</code></pre></div></div>

<p>Originally published as a <a href="https://gist.github.com/infojunkie/6f9e6d0c9dce9be44116b7a828accc20" rel="noopener noreferrer" target="_blank">GitHub gist</a>.</p>

  </div>

  

  
    
<script data-isso="https://blog.karimratib.me/isso" src="https://blog.karimratib.me/isso/js/embed.min.js"></script>
<section id="isso-thread"></section>


  
</article>

      </div>
    </main>

    <footer class="site-footer">

  <div class="wrapper">

    <h2 class="footer-heading">infojunkie</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li>
            <a href="/assets/CV-KarimRATIB.pdf">
              my resume
            </a>
          </li>
          <li>
            <a href="https://github.com/infojunkie/blog" rel="noopener noreferrer" target="_blank">
              blog source
            </a>
          </li>
        </ul>

        <p class="rss-subscribe">subscribe <a href="/feed.xml">via RSS</a></p>

      </div>

      <div class="footer-col footer-col-2">
        <ul class="social-media-list">
          <li>
            <a href="https://thereisamoduleforthat.com" rel="noopener noreferrer" target="_blank">
              <img src="/assets/tmft.svg">
              There's a module for that!
            </a>
          </li>
          <li>
            <a href="https://github.com/infojunkie" rel="noopener noreferrer" target="_blank">
              <svg class="icon"><use xlink:href="#fab.fa-github"></use></svg>
              GitHub
            </a>
          </li>
          <li>
            <a href="https://www.youtube.com/@KarimRatib" rel="noopener noreferrer" target="_blank">
              <svg class="icon"><use xlink:href="#fab.fa-youtube"></use></svg>
              YouTube
            </a>
          </li>
          <li>
            <a href="https://musescore.com/infojunkie" rel="noopener noreferrer" target="_blank">
              <svg class="icon"><use xlink:href="#fas.fa-music"></use></svg>
              MuseScore
            </a>
          </li>
          <li>
            <a href="mailto:karim.ratib@gmail.com">
              <svg class="icon"><use xlink:href="#far.fa-envelope"></use></svg>
              email
            </a>
          </li>
        </ul>
      </div>

      <div class="footer-col footer-col-3">
      </div>
    </div>

    <div class="footer-col">
      <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png"></a><br>This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.
    </div>

  </div>

  <svg display="none" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                  <defs>
                  <!--
                  Font Awesome Free 5.5.0 by @fontawesome - https://fontawesome.com
                  License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License)
                  -->
              <symbol id="fab.fa-github" viewbox="0 0 496 512">
            <title>github</title>
            <path class="path1" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path>
        </symbol>
        <symbol id="fab.fa-youtube" viewbox="0 0 576 512">
            <title>youtube</title>
            <path class="path1" d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"></path>
        </symbol>
        <symbol id="fas.fa-music" viewbox="0 0 512 512">
            <title>music</title>
            <path class="path1" d="M499.1 6.3c8.1 6 12.9 15.6 12.9 25.7v72V368c0 44.2-43 80-96 80s-96-35.8-96-80s43-80 96-80c11.2 0 22 1.6 32 4.6V147L192 223.8V432c0 44.2-43 80-96 80s-96-35.8-96-80s43-80 96-80c11.2 0 22 1.6 32 4.6V200 128c0-14.1 9.3-26.6 22.8-30.7l320-96c9.7-2.9 20.2-1.1 28.3 5z"></path>
        </symbol>
        <symbol id="far.fa-envelope" viewbox="0 0 512 512">
            <title>envelope</title>
            <path class="path1" d="M64 112c-8.8 0-16 7.2-16 16v22.1L220.5 291.7c20.7 17 50.4 17 71.1 0L464 150.1V128c0-8.8-7.2-16-16-16H64zM48 212.2V384c0 8.8 7.2 16 16 16H448c8.8 0 16-7.2 16-16V212.2L322 328.8c-38.4 31.5-93.7 31.5-132 0L48 212.2zM0 128C0 92.7 28.7 64 64 64H448c35.3 0 64 28.7 64 64V384c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V128z"></path>
        </symbol>
        </defs>
              </svg>

</footer>


  </body>

</html>
